<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Music Terms Quiz</title>
    <style>
        :root {
            --primary: #4A90E2;
            --success: #2ECC71;
            --error: #E74C3C;
            --bg: #f5f7fa;
            --card: #ffffff;
            --text: #2c3e50;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 20px;
            padding-bottom: 50px; /* Space for footer */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            box-sizing: border-box;
        }

        .container {
            background: var(--card);
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 600px;
            padding: 30px;
            text-align: center;
            position: relative;
            z-index: 1;
        }

        h1 { margin-bottom: 10px; font-size: 28px; color: var(--primary); }
        .subtitle { color: #7f8c8d; margin-bottom: 30px; font-size: 16px; }
        
        .mode-select button, .option-btn, .next-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin: 5px;
            transition: transform 0.1s, opacity 0.2s;
            width: 100%;
            max-width: 300px;
        }

        .mode-select button:hover { transform: translateY(-2px); }
        
        .option-btn {
            background: white;
            border: 2px solid #e0e0e0;
            color: var(--text);
            margin-bottom: 10px;
            text-align: left;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .option-btn:hover { border-color: var(--primary); background: #f0f7ff; }
        .option-btn.correct { background: var(--success); color: white; border-color: var(--success); }
        .option-btn.wrong { background: var(--error); color: white; border-color: var(--error); }

        .quiz-area { display: none; }
        
        .term-container {
            margin: 20px 0;
        }

        .term-display {
            font-size: 32px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .term-ipa {
            display: block;
            font-size: 16px;
            color: #7f8c8d;
            font-family: "Lucida Sans Unicode", "Arial Unicode MS", sans-serif;
            margin-top: 5px;
            font-weight: normal;
        }

        .audio-btn {
            background: none;
            border: 2px solid #eee;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.2s;
            flex-shrink: 0;
        }
        .audio-btn:hover { background-color: #f0f0f0; transform: scale(1.1); }
        .audio-btn:active { background-color: #e0e0e0; transform: scale(0.95); }

        .feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            background: #f8f9fa;
            display: none;
            text-align: left;
            border-left: 5px solid #ccc;
        }

        .feedback.show { display: block; }
        .feedback.success { border-left-color: var(--success); }
        .feedback.error { border-left-color: var(--error); }

        /* Pinyin Styling */
        .pronunciation-guide {
            margin-top: 10px;
            font-size: 14px;
            color: #555;
            background: #eee;
            padding: 8px;
            border-radius: 5px;
        }
        .pinyin-row { display: flex; gap: 10px; margin-bottom: 2px; }
        .pinyin-label { font-weight: bold; color: #888; width: 65px; flex-shrink: 0; text-align: right; margin-right: 5px; }
        .pinyin-text { font-family: monospace; font-size: 15px; color: #333; }

        .stats {
            margin-top: 20px;
            font-size: 14px;
            color: #7f8c8d;
            display: flex;
            justify-content: space-between;
        }

        .hidden { display: none; }

        /* Footer Signature */
        .footer-credit {
            position: fixed;
            bottom: 5px;
            left: 0;
            width: 100%;
            text-align: center;
            color: #d1d5db; /* Ê•µÊ∑°ÁÅ∞Ëâ≤ */
            font-size: 11px; /* Ê•µÂ∞èÂ≠óÈ´î */
            z-index: 0; 
            pointer-events: none; /* ÈªûÊìäÁ©øÈÄè */
            font-family: sans-serif;
            letter-spacing: 1px;
        }

    </style>
</head>
<body>

<div class="container" id="app">
    <div id="start-screen">
        <h1>Music Terms Quiz</h1>
        <p class="subtitle">Italian, German & French Terms</p>
        
        <div class="mode-select">
            <button onclick="startQuiz('zh')">‰∏≠ÊñáÊ®°Âºè (Chinese Mode)</button>
            <button onclick="startQuiz('en')">English Mode</button>
        </div>
        <div style="margin-top: 30px; font-size: 13px; color: #999; line-height: 1.6;">
            üí° ÈªûÊìä <span style="font-size:16px">üîä</span> ÂúñÁ§∫ËÅÜËÅΩÁôºÈü≥<br>
            (Click the speaker icon to hear pronunciation)
        </div>
    </div>

    <div id="quiz-screen" class="quiz-area">
        <div class="stats">
            <span id="score-display">Score: 0</span>
            <span id="progress-display">Q: 1 / ‚àû</span>
        </div>

        <div class="term-container">
            <div class="term-display">
                <span id="question-term">Loading...</span>
                <button onclick="playAudio()" class="audio-btn" title="Listen">üîä</button>
            </div>
            <span id="question-ipa" class="term-ipa"></span>
        </div>

        <div id="options-container">
            </div>

        <div id="feedback-area" class="feedback">
            <h3 id="feedback-title"></h3>
            <div id="feedback-content"></div>
            
            <div id="pronunciation-box" class="pronunciation-guide hidden">
                <div class="pinyin-row">
                    <span class="pinyin-label">Á≤µË™ûÊì¨Èü≥:</span>
                    <span id="canto-text" class="pinyin-text"></span>
                </div>
                <div class="pinyin-row">
                    <span class="pinyin-label">ÂúãË™ûÊì¨Èü≥:</span>
                    <span id="mando-text" class="pinyin-text"></span>
                </div>
            </div>
        </div>

        <button id="next-btn" class="next-btn hidden" onclick="nextQuestion()">Next Question</button>
        <button class="next-btn" style="background:#95a5a6; margin-top:20px;" onclick="location.reload()">Menu</button>
    </div>
</div>

<div class="footer-credit">
    Ë±êÁãÇÂá∫ÂìÅ ‚Ä¢ Ê®ÇÁêÜÈö®Ë∫´ËÅΩ
</div>

<script>
    // --- Data Configuration ---
    
    // Ë™ûË®Ä‰ª£Á¢ºÂ∞çÁÖßË°®
    const langMap = {
        "Italian": "it-IT",
        "German": "de-DE",
        "French": "fr-FR",
        "Latin": "it-IT", 
        "English": "en-US"
    };

    /* canto: Á≤µË™ûÁ©∫ËÄ≥/Êì¨Èü≥ (Transliteration closest to Cantonese sounds)
       mando: ÂúãË™ûÁ©∫ËÄ≥/Êì¨Èü≥ (Transliteration closest to Mandarin sounds)
    */
    const musicTerms = [
        // --- Tempo / Speed ---
        { term: "langsam", ipa: "/Ààla≈ãzaÀêm/", def: "ÊÖ¢ÁöÑ", lang: "German", en: "Slow", canto: "Laang-Zaam", mando: "LƒÅng-ZƒÅm" },
        { term: "lent", ipa: "/l…ëÃÉ/", def: "ÊÖ¢ÁöÑ", lang: "French", en: "Slow", canto: "Long", mando: "LƒÅng" },
        { term: "largo", ipa: "/Ààlar.…°o/", def: "Âª£Êùø (ÂØ¨Âª£Âú∞„ÄÅÁ∑©ÊÖ¢Âú∞)", lang: "Italian", en: "Broad, slow", canto: "Laa-Go", mando: "LƒÅ-G≈çu" },
        { term: "lento", ipa: "/Ààl…õn.to/", def: "ÊÖ¢Êùø", lang: "Italian", en: "Slow", canto: "Len-Toe", mando: "Lƒìn-T≈çu" },
        { term: "larghetto", ipa: "/larÀà…°et.to/", def: "Â∞èÂª£Êùø", lang: "Italian", en: "Rather broad", canto: "Laa-Get-Toe", mando: "LƒÅ-Gƒõi-T≈çu" },
        { term: "andantino", ipa: "/an.danÀàti.no/", def: "Â∞èË°åÊùø", lang: "Italian", en: "Slightly faster/slower than Andante", canto: "An-Daan-Ti-No", mando: "ƒÄn-D√†n-Tƒ´-Nu√≤" },
        { term: "andante", ipa: "/anÀàdan.te/", def: "Ë°åÊùø", lang: "Italian", en: "Walking pace", canto: "An-Daan-Tay", mando: "ƒÄn-D√†n-Tƒìi" },
        { term: "comodo", ipa: "/Ààk…î.mo.do/", def: "ËàíÈÅ©Âú∞", lang: "Italian", en: "Comfortable", canto: "Ko-Mo-Do", mando: "K≈çu-M√≥-Du≈ç" },
        { term: "mod√©r√©", ipa: "/m…î.de. Åe/", def: "‰∏≠Á≠âÁöÑ", lang: "French", en: "Moderate", canto: "Mo-Day-Ray", mando: "M√≥-D√©-R√©i" },
        { term: "m√§√üig", ipa: "/Ààm…õÀês…™√ß/", def: "‰∏≠Á≠âÁöÑ", lang: "German", en: "Moderate", canto: "Me-Sich", mando: "Mƒìi-Sƒ´-Hƒì" },
        { term: "meno mosso", ipa: "/Ààme.no Ààm…îs.so/", def: "Á®çÊÖ¢", lang: "Italian", en: "Less movement", canto: "May-No Mos-So", mando: "Mƒìi-Nu√≤ M√≥-Su«í" },
        { term: "retenu", ipa: "/ Å…ô.t…ô.ny/", def: "Á™ÅÊÖ¢", lang: "French", en: "Held back", canto: "Re-Ten-New", mando: "Ruƒì-T√®-Ni≈´" },
        { term: "rubato", ipa: "/ruÀàba.to/", def: "ÂΩàÊÄßÈÄüÂ∫¶", lang: "Italian", en: "Robbed time", canto: "Ru-Baa-Toe", mando: "L«î-BƒÅ-T≈çu" },
        { term: "ritenuto", ipa: "/ri.teÀànu.to/", def: "Á™ÅÊÖ¢", lang: "Italian", en: "Held back", canto: "Ri-Ten-Nu-Toe", mando: "Ru√¨-T√®-N«î-T≈çu" },
        { term: "rallentando", ipa: "/ral.lenÀàtan.do/", def: "Êº∏ÊÖ¢", lang: "Italian", en: "Gradually slower", canto: "Raa-Len-Taan-Do", mando: "RuƒÅ-L√©n-T√†n-Du≈ç" },
        { term: "ritardando", ipa: "/ri.tarÀàdan.do/", def: "Êº∏ÊÖ¢", lang: "Italian", en: "Gradually slower", canto: "Ri-Taa-Daan-Do", mando: "Ru√¨-T√†-D√†n-Du≈ç" },
        { term: "a tempo", ipa: "/a Ààt…õm.po/", def: "ÂõûÂéüÈÄü", lang: "Italian", en: "Back to original speed", canto: "Ah Tem-Po", mando: "ƒÄ Tƒìm-P≈çu" },
        { term: "come prima", ipa: "/Ààko.me Ààpri.ma/", def: "Â¶ÇÂàù", lang: "Italian", en: "As before", canto: "Ko-May Pri-Ma", mando: "K≈çu-Mƒìi P«î-L√¨-M«é" },
        { term: "alla breve", ipa: "/Ààal.la Ààbr…õ.ve/", def: "‰∫å‰∫åÊãç", lang: "Italian", en: "Cut common time", canto: "Ah-La Bre-Ve", mando: "ƒÄ-LƒÅ Bu-R√©i-Vƒìi" },
        { term: "alla marcia", ipa: "/Ààal.la Ààmar.t Éa/", def: "ÈÄ≤Ë°åÊõ≤È¢®Ê†º", lang: "Italian", en: "In the style of a march", canto: "Ah-La Maa-Cha", mando: "ƒÄ-LƒÅ M«é-Qi√†" },
        { term: "grazioso", ipa: "/…°ratÀàtsjo.zo/", def: "ÂÑ™ÈõÖÂú∞", lang: "Italian", en: "Graceful", canto: "Graat-Zi-O-So", mando: "G√©-LƒÅ-Q√¨-≈åu-Su≈ç" },
        { term: "allegretto", ipa: "/al.leÀà…°ret.to/", def: "Â∞èÂø´Êùø", lang: "Italian", en: "Fairly fast", canto: "Ah-Le-Gret-Toe", mando: "ƒÄ-L√©i-Guƒõi-T≈çu" },
        { term: "allegro", ipa: "/alÀàle.…°ro/", def: "Âø´Êùø", lang: "Italian", en: "Fast, lively", canto: "Ah-Le-Gro", mando: "ƒÄ-L√©i-Gu≈ç" },
        { term: "pi√π mosso", ipa: "/pju Ààm…îs.so/", def: "Á®çÂø´", lang: "Italian", en: "More movement", canto: "Pew Mos-So", mando: "Pi-Y≈çu M√≥-Su«í" },
        { term: "animato", ipa: "/a.niÀàma.to/", def: "ÁîüÂãïÂú∞", lang: "Italian", en: "Animated", canto: "Ah-Ni-Maa-Toe", mando: "ƒÄ-N√≠-M«é-T≈çu" },
        { term: "vivace", ipa: "/viÀàva.t Ée/", def: "ÁîöÂø´ / ÂÖÖÊªøÊ¥ªÂäõ", lang: "Italian", en: "Lively, quick", canto: "Vi-Vaa-Chi", mando: "Vƒ´-VƒÅ-Qi√®" },
        { term: "vivo", ipa: "/Ààvi.vo/", def: "Ê¥ªÊΩëÂú∞", lang: "Italian", en: "Lively", canto: "Vi-Vo", mando: "Vƒ´-V≈çu" },
        { term: "stringendo", ipa: "/strinÀàd í…õn.do/", def: "Âä†Á∑ä (Êº∏Âø´)", lang: "Italian", en: "Pressing on", canto: "Strin-Jen-Do", mando: "Si-T√®-L√≠n-JiƒÅn-Du≈ç" },
        { term: "vite", ipa: "/vit/", def: "Âø´ÈÄüÂú∞", lang: "French", en: "Fast", canto: "Veet", mando: "V√¨-T√®" },
        { term: "schnell", ipa: "/ Én…õl/", def: "Âø´ÈÄüÂú∞", lang: "German", en: "Fast", canto: "Sh-Nel", mando: "Shƒ´-N√†i-Er" },
        { term: "presto", ipa: "/Ààpr…õs.to/", def: "ÊÄ•Êùø", lang: "Italian", en: "Very fast", canto: "Pres-Toe", mando: "P«î-Ruƒìi-Sƒ´-T≈çu" },
        { term: "prestissimo", ipa: "/presÀàtis.si.mo/", def: "ÊúÄÊÄ•Êùø", lang: "Italian", en: "As fast as possible", canto: "Pres-Tis-Si-Mo", mando: "P«î-Ruƒìi-Sƒ´-T√≠-Sƒ´-M√≥" },
        { term: "accelerando", ipa: "/at.t Ée.leÀàran.do/", def: "Êº∏Âø´", lang: "Italian", en: "Gradually faster", canto: "Ah-Che-Le-Raan-Do", mando: "ƒÄ-Qi√®-L√©i-Ru«én-Du≈ç" },
        
        // --- Navigation ---
        { term: "da capo", ipa: "/da Ààka.po/", def: "ÂæûÈ†≠ÂÜçÂ•è", lang: "Italian", en: "From the beginning", canto: "Daa Ka-Po", mando: "D√° K«é-P≈çu" },
        { term: "fine", ipa: "/Ààfi.ne/", def: "ÁµêÊùü", lang: "Italian", en: "The end", canto: "Fi-Nay", mando: "Fƒìi-N√©i" },
        { term: "dal segno", ipa: "/dal Ààse.…≤o/", def: "ÂæûË®òËôüËôïÂÜçÂ•è", lang: "Italian", en: "From the sign", canto: "Daal Sen-Yo", mando: "D√°l Sƒìn-Y≈çu" },
        { term: "attacca", ipa: "/atÀàtak.ka/", def: "Á∑äÊé•‰∏ãÊÆµ", lang: "Italian", en: "Go straight on", canto: "Ah-Taak-Ka", mando: "ƒÄ-T«é-K«é" },
        
        // --- Style ---
        { term: "legato", ipa: "/leÀà…°a.to/", def: "ÂúìÊªëÂ•è", lang: "Italian", en: "Smoothly", canto: "Le-Gaa-Toe", mando: "L√©i-GƒÅ-T≈çu" },
        { term: "staccato", ipa: "/stakÀàka.to/", def: "Êñ∑Â•è", lang: "Italian", en: "Detached", canto: "Sta-Kaa-Toe", mando: "Sƒ´-T«é-K«é-T≈çu" },
        { term: "leggiero", ipa: "/ledÀàd í…õ.ro/", def: "ËºïÂ∑ßÂú∞", lang: "Italian", en: "Lightly", canto: "Le-Jee-E-Ro", mando: "L√©i-Ji√©-Lu≈ç" },
        { term: "marcato", ipa: "/marÀàka.to/", def: "Âä†Âº∑Èü≥", lang: "Italian", en: "Marked", canto: "Maa-Kaa-Toe", mando: "M«é-K«é-T≈çu" },
        { term: "prima", ipa: "/Ààpri.ma/", def: "Á¨¨‰∏Ä", lang: "Italian", en: "First", canto: "Pri-Ma", mando: "P«î-L√¨-M«é" },
        { term: "simile", ipa: "/Ààsi.mi.le/", def: "ÂêåÂâç", lang: "Italian", en: "In the same way", canto: "Si-Mi-Lay", mando: "Sƒ´-M«ê-L√©i" },
        { term: "ad libitum", ipa: "/ad Ààli.bi.tum/", def: "Èö®ÊÑèÂú∞", lang: "Latin", en: "At choice", canto: "Ad Li-Bi-Tum", mando: "ƒÄ-D√© L√¨-B«ê-T«î-M«î" },
        
        // --- Dynamics ---
        { term: "crescendo", ipa: "/kreÀà É…õn.do/", def: "Êº∏Âº∑", lang: "Italian", en: "Gradually louder", canto: "Kre-Shen-Do", mando: "Kƒõ-Ruƒìi-XuƒÅn-Du≈ç" },
        { term: "decrescendo", ipa: "/de.kreÀà É…õn.do/", def: "Êº∏Âº±", lang: "Italian", en: "Gradually softer", canto: "Day-Kre-Shen-Do", mando: "Dƒìi-Kƒõ-Ruƒìi-XuƒÅn-Du≈ç" },
        { term: "diminuendo", ipa: "/di.mi.nuÀà…õn.do/", def: "Êº∏Âº±", lang: "Italian", en: "Gradually softer", canto: "Di-Min-Yu-En-Do", mando: "D√¨-M«ê-Ni«î-Wƒìn-Du≈ç" },
        { term: "forte", ipa: "/Ààf…îr.te/", def: "Âº∑", lang: "Italian", en: "Loud", canto: "For-Tay", mando: "F√≥-Tƒìi" },
        { term: "fortissimo", ipa: "/forÀàtis.si.mo/", def: "ÁîöÂº∑", lang: "Italian", en: "Very loud", canto: "For-Tis-Si-Mo", mando: "F√≥-T√≠-Sƒ´-M√≥" },
        { term: "mezzo piano", ipa: "/Ààm…õd.dzo Ààpja.no/", def: "‰∏≠Âº±", lang: "Italian", en: "Moderately soft", canto: "Met-So Pi-Aa-No", mando: "Mƒìi-Zu«í Pƒ´-A-Nu√≤" },
        { term: "piano", ipa: "/Ààpja.no/", def: "Âº±", lang: "Italian", en: "Soft", canto: "Pi-Aa-No", mando: "Pƒ´-A-Nu√≤" },
        { term: "pianissimo", ipa: "/pjaÀànis.si.mo/", def: "ÁîöÂº±", lang: "Italian", en: "Very soft", canto: "Pi-Aa-Nis-Si-Mo", mando: "Pƒ´-A-N√≠-Sƒ´-M√≥" },
        { term: "fortepiano", ipa: "/Ààf…îr.te Ààpja.no/", def: "Âº∑ÂæåÁ™ÅÂº±", lang: "Italian", en: "Loud then soft", canto: "For-Tay Pi-Aa-No", mando: "F√≥-Tƒìi Pƒ´-A-Nu√≤" },
        { term: "sforzando", ipa: "/sforÀàtsan.do/", def: "Á™ÅÂº∑", lang: "Italian", en: "Forced", canto: "Sfor-Tsaan-Do", mando: "Sƒ´-F√≥-C«én-Du≈ç" },
        { term: "rinforzando", ipa: "/rin.forÀàtsan.do/", def: "Âä†Âº∑", lang: "Italian", en: "Reinforcing", canto: "Rin-For-Tsaan-Do", mando: "L√≠n-F√≥-C«én-Du≈ç" },
        
        // --- Mood ---
        { term: "cantabile", ipa: "/kanÀàta.bi.le/", def: "Â¶ÇÊ≠åÂú∞", lang: "Italian", en: "Singing style", canto: "Kaan-Taa-Bi-Lay", mando: "KƒÅn-T«é-B«ê-L√©i" },
        { term: "dolce", ipa: "/Ààdol.t Ée/", def: "ÁîúÁæéÂú∞", lang: "Italian", en: "Sweet", canto: "Dol-Chay", mando: "Du≈ç-Qi√®" },
        { term: "espressivo", ipa: "/es.presÀàsi.vo/", def: "ÂØåÊúâË°®ÊÉÖÂú∞", lang: "Italian", en: "Expressive", canto: "Es-Pres-Si-Vo", mando: "Ai-Sƒ´-P«î-Ruƒìi-Sƒ´-V≈çu" },
        { term: "con forza", ipa: "/kon Ààf…îr.tsa/", def: "ÊúâÂäõÂú∞", lang: "Italian", en: "With force", canto: "Kon For-Tsa", mando: "K≈çng F√≥-CƒÅ" },
        { term: "energico", ipa: "/eÀàn…õr.d íi.ko/", def: "Á≤æÂäõÂÖÖÊ≤õÂú∞", lang: "Italian", en: "Energetic", canto: "En-Er-Ji-Ko", mando: "Ai-N√†i-J√≠-K≈çu" },
        { term: "giocoso", ipa: "/d íoÀàko.zo/", def: "Ë©ºË´ßÂú∞", lang: "Italian", en: "Playful", canto: "Jo-Ko-So", mando: "Ji√†o-K≈çu-Su≈ç" },
        { term: "scherzando", ipa: "/skerÀàtsan.do/", def: "Êà≤Ë¨îÂú∞", lang: "Italian", en: "Playful, joking", canto: "Sker-Tsaan-Do", mando: "Sƒ´-Kƒõ-C«én-Du≈ç" },
        { term: "semplice", ipa: "/Ààs…õm.pli.t Ée/", def: "ÂñÆÁ¥îÂú∞", lang: "Italian", en: "Simple", canto: "Sem-Pli-Chay", mando: "Sƒìn-P«î-L«ê-Qi√®" },
        { term: "sostenuto", ipa: "/so.steÀànu.to/", def: "ÊåÅÁ∫åÂú∞", lang: "Italian", en: "Sustained", canto: "Sos-Ten-Nu-Toe", mando: "Su«í-Sƒ´-T√®-N«î-T≈çu" },
        { term: "subito", ipa: "/Ààsu.bi.to/", def: "Á™ÅÁÑ∂Âú∞", lang: "Italian", en: "Suddenly", canto: "Su-Bi-Toe", mando: "S≈´-B«ê-T≈çu" },
        { term: "tranquillo", ipa: "/tranÀàkwil.lo/", def: "Âπ≥ÈùúÂú∞", lang: "Italian", en: "Calm", canto: "Traan-Kwil-Lo", mando: "T√®-Lu«én-Kuƒ´-Lu≈ç" },
        { term: "triste", ipa: "/Ààtri.ste/", def: "ÊÇ≤ÂÇ∑Âú∞", lang: "Italian", en: "Sad", canto: "Tris-Tay", mando: "T√®-Ru√¨-Sƒ´-Tƒìi" },
        { term: "affettuoso", ipa: "/af.fetÀàtwo.zo/", def: "Ê∑±ÊÉÖÂú∞", lang: "Italian", en: "Affectionate", canto: "Ah-Fet-Two-So", mando: "ƒÄ-Fƒìi-Tu≈ç-Su≈ç" },
        { term: "amabile", ipa: "/aÀàma.bi.le/", def: "ÂèØÊÑõÂú∞", lang: "Italian", en: "Amiable", canto: "Ah-Maa-Bi-Lay", mando: "ƒÄ-M«é-B«ê-L√©i" },
        { term: "appassionato", ipa: "/ap.pas.sjoÀàna.to/", def: "ÁÜ±ÊÉÖÂú∞", lang: "Italian", en: "Passionate", canto: "Ah-Pas-Sio-Naa-Toe", mando: "ƒÄ-P√†-Sio-N«é-T≈çu" },
        { term: "con brio", ipa: "/kon Ààbri.o/", def: "ÊúâÊ¥ªÂäõÂú∞", lang: "Italian", en: "With vigour", canto: "Kon Bri-O", mando: "K≈çng B√π-L«ê-≈åu" },
        { term: "deciso", ipa: "/deÀàt Éi.zo/", def: "Â†ÖÂÆöÂú∞", lang: "Italian", en: "Determined", canto: "De-Chi-So", mando: "Dƒìi-Q√≠-Su≈ç" },
        { term: "mesto", ipa: "/Ààm…õ.sto/", def: "ÊÜÇÈ¨±Âú∞", lang: "Italian", en: "Sad", canto: "Mes-Toe", mando: "Mƒìi-Sƒ´-T≈çu" },
        { term: "misterioso", ipa: "/mi.steÀàrjo.zo/", def: "Á•ûÁßòÂú∞", lang: "Italian", en: "Mysterious", canto: "Mis-Tay-Rio-So", mando: "M«ê-Sƒ´-T√®-Li√≥-Su≈ç" },
        { term: "anim√©", ipa: "/a.ni.me/", def: "Ê¥ªË∫çÁöÑ", lang: "French", en: "Animated", canto: "Ah-Ni-May", mando: "ƒÄ-N√≠-Mƒìi" },
        { term: "douce", ipa: "/dus/", def: "ÁîúÁæéÁöÑ", lang: "French", en: "Sweet", canto: "Doos", mando: "D√π-Sƒ´" },
        { term: "lebhaft", ipa: "/ÀàleÀêphaft/", def: "Ê¥ªÊΩëÁöÑ", lang: "German", en: "Lively", canto: "Layp-Haft", mando: "L√©i-P«î-HƒÅ-F≈´-T√®" },
        { term: "ruhig", ipa: "/ÀàruÀê…™√ß/", def: "Âπ≥ÈùúÁöÑ", lang: "German", en: "Peaceful", canto: "Ru-Hick", mando: "L√π-Xƒ´-K√®" },
        { term: "traurig", ipa: "/Ààt Åa äÃØ Å…™√ß/", def: "ÊÇ≤ÂÇ∑ÁöÑ", lang: "German", en: "Sad", canto: "Trao-Rick", mando: "T√®-L√°o-L«ê-K√®" },
        { term: "morendo", ipa: "/moÀàr…õn.do/", def: "Êº∏Âº±Ê∂àÂ§±", lang: "Italian", en: "Dying away", canto: "Mo-Ren-Do", mando: "M√≥-Ruƒìi-En-Du≈ç" },
        { term: "perdendosi", ipa: "/perÀàd…õn.do.si/", def: "ÈÄêÊº∏Ê∂àÂ§±", lang: "Italian", en: "Dying away", canto: "Per-Den-Do-Si", mando: "P√©i-Dƒõn-Du≈ç-Sƒ´" },
        { term: "smorzando", ipa: "/zmorÀàtsan.do/", def: "Êº∏ÊÖ¢‰∏îÊº∏Âº±", lang: "Italian", en: "Dying away", canto: "Smor-Tsaan-Do", mando: "Sƒ´-M√≥-C«én-Du≈ç" },
        { term: "sotto voce", ipa: "/Ààsot.to Ààvo.t Ée/", def: "‰ΩéËÅ≤Âú∞", lang: "Italian", en: "Undertone", canto: "Sot-To Vo-Chay", mando: "Su«í-T≈çu V≈çu-Qi√®" },
        
        // --- Conjunctions ---
        { term: "con", ipa: "/kon/", def: "Áî®„ÄÅ‰º¥Èö®Ëëó", lang: "Italian", en: "With", canto: "Kon", mando: "K≈çng" },
        { term: "ma", ipa: "/ma/", def: "‰ΩÜÊòØ", lang: "Italian", en: "But", canto: "Maa", mando: "M«é" },
        { term: "meno", ipa: "/Ààme.no/", def: "ËºÉÂ∞ë", lang: "Italian", en: "Less", canto: "May-No", mando: "Mƒìi-Nu√≤" },
        { term: "molto", ipa: "/Ààmol.to/", def: "Âæà„ÄÅÁîö", lang: "Italian", en: "Very", canto: "Mol-Toe", mando: "M√≥-Er-T≈çu" },
        { term: "non", ipa: "/non/", def: "‰∏ç", lang: "Italian", en: "Not", canto: "Non", mando: "N√≤ng" },
        { term: "troppo", ipa: "/Ààtr…îp.po/", def: "Â§™„ÄÅÈÅéÂ§ö", lang: "Italian", en: "Too much", canto: "Trop-Po", mando: "Tu≈ç-P≈çu" },
        { term: "pi√π", ipa: "/pju/", def: "Êõ¥Â§ö", lang: "Italian", en: "More", canto: "Pew", mando: "Pi-Y≈çu" },
        { term: "poco", ipa: "/Ààp…î.ko/", def: "‰∏ÄÈªûÈªû", lang: "Italian", en: "A little", canto: "Po-Ko", mando: "P≈çu-K≈çu" },
        { term: "assai", ipa: "/asÀàsai/", def: "ÈùûÂ∏∏", lang: "Italian", en: "Very", canto: "As-Sai", mando: "ƒÄ-SƒÅi" },
        { term: "quasi", ipa: "/Ààkwa.zi/", def: "Âπæ‰πé", lang: "Italian", en: "As if", canto: "Kwaa-Zi", mando: "KuƒÅ-Zƒ´" },
        { term: "sempre", ipa: "/Ààs…õm.pre/", def: "ÂßãÁµÇ", lang: "Italian", en: "Always", canto: "Sem-Pray", mando: "Sƒìn-P«î-R√©i" },
        { term: "senza", ipa: "/Ààs…õn.tsa/", def: "Ê≤íÊúâ", lang: "Italian", en: "Without", canto: "Sen-Tsa", mando: "Sƒìn-CƒÅ" },
        { term: "ben", ipa: "/b…õn/", def: "ÂÖÖÂàÜÂú∞", lang: "Italian", en: "Well", canto: "Ben", mando: "Bƒìn" },
        
        // --- Others ---
        { term: "grave", ipa: "/Àà…°ra.ve/", def: "ËéäÊùø", lang: "Italian", en: "Very slow", canto: "Graa-Vay", mando: "G√©-LƒÅ-Vƒìi" },
        { term: "allargando", ipa: "/al.larÀà…°an.do/", def: "Êº∏ÂØ¨Âª£", lang: "Italian", en: "Broadening", canto: "Ah-Lar-Gaan-Do", mando: "ƒÄ-LƒÅ-G«én-Du≈ç" },
        { term: "con moto", ipa: "/kon Ààm…î.to/", def: "ÊúâÂãïÊÑüÂú∞", lang: "Italian", en: "With movement", canto: "Kon Mo-Toe", mando: "K≈çng M√≥-T≈çu" },
        { term: "agitato", ipa: "/a.d íiÀàta.to/", def: "ÊøÄÂãïÂú∞", lang: "Italian", en: "Agitated", canto: "Ah-Ji-Taa-Toe", mando: "ƒÄ-J√≠-T«é-T≈çu" },
        { term: "maestoso", ipa: "/ma.eÀàsto.zo/", def: "ËéäÂö¥Âú∞", lang: "Italian", en: "Majestic", canto: "Mai-Sto-So", mando: "M√†i-Sƒ´-Tu≈ç-Su≈ç" },
        { term: "pesante", ipa: "/peÀàzan.te/", def: "Ê≤àÈáçÂú∞", lang: "Italian", en: "Heavy", canto: "Pe-Zaan-Tay", mando: "Pƒìi-Z«én-Tƒìi" },
        { term: "risoluto", ipa: "/ri.zoÀàlu.to/", def: "ÊûúÊñ∑Âú∞", lang: "Italian", en: "Bold", canto: "Ri-Zo-Lu-Toe", mando: "Ru√¨-Zu«í-L«î-T≈çu" },
        { term: "ritmico", ipa: "/Ààrit.mi.ko/", def: "ÊúâÁØÄÂ•èÂú∞", lang: "Italian", en: "Rhythmic", canto: "Rit-Mi-Ko", mando: "Ru√¨-T√®-M«ê-K≈çu" },
        { term: "cantando", ipa: "/kanÀàtan.do/", def: "Ê≠åÂî±Ëà¨Âú∞", lang: "Italian", en: "Singing", canto: "Kaan-Taan-Do", mando: "KƒÅn-T«én-Du≈ç" },
        { term: "con dolore", ipa: "/kon doÀàlo.re/", def: "ÊÇ≤ÁóõÂú∞", lang: "Italian", en: "With grief", canto: "Kon Do-Lo-Ray", mando: "K≈çng Du≈ç-Lu≈ç-R√©i" },
        { term: "con spirito", ipa: "/kon Ààspi.ri.to/", def: "ÊúâÁ≤æÁ•ûÂú∞", lang: "Italian", en: "With spirit", canto: "Kon Spi-Ri-Toe", mando: "K≈çng Sƒ´-Pƒ´-L«ê-T≈çu" },
        { term: "doloroso", ipa: "/do.loÀàro.zo/", def: "ÁóõËã¶Âú∞", lang: "Italian", en: "Sorrowful", canto: "Do-Lo-Ro-So", mando: "Du≈ç-Lu≈ç-Ru≈ç-Su≈ç" },
        { term: "largamente", ipa: "/lar.…°aÀàmen.te/", def: "ÂØ¨Âª£Âú∞", lang: "Italian", en: "Broadly", canto: "Lar-Gaa-Men-Tay", mando: "LƒÅ-G«é-Mƒìn-Tƒìi" },
        { term: "sonoro", ipa: "/soÀàn…î.ro/", def: "Èüø‰∫ÆÂú∞", lang: "Italian", en: "Resonant", canto: "So-No-Ro", mando: "Su«í-Nu√≤-Lu≈ç" },
        { term: "a niente", ipa: "/a Àànj…õn.te/", def: "Êº∏Âº±Ëá≥ÁÑ°ËÅ≤", lang: "Italian", en: "To nothing", canto: "Ah Nyen-Tay", mando: "ƒÄ Ni-Yƒõn-Tƒìi" }
    ];

    let currentMode = 'zh'; 
    let currentQuestion = null;
    let score = 0;
    let questionCount = 0;
    let isAnswering = true;

    function startQuiz(mode) {
        currentMode = mode;
        document.getElementById('start-screen').style.display = 'none';
        document.getElementById('quiz-screen').style.display = 'block';
        nextQuestion();
    }

    function getRandomItem(array) {
        return array[Math.floor(Math.random() * array.length)];
    }

    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
    }

    function generateOptions(correctItem) {
        const options = [correctItem];
        while (options.length < 4) {
            const randomItem = getRandomItem(musicTerms);
            if (!options.includes(randomItem)) {
                options.push(randomItem);
            }
        }
        shuffleArray(options);
        return options;
    }

    function playAudio() {
        if (!currentQuestion) return;
        let textToSpeak = currentQuestion.term;
        const langName = currentQuestion.lang; 
        const langCode = langMap[langName] || "en-US"; 

        if ('speechSynthesis' in window) {
            window.speechSynthesis.cancel();
            const utterance = new SpeechSynthesisUtterance(textToSpeak);
            utterance.lang = langCode;
            utterance.rate = 0.8; 
            window.speechSynthesis.speak(utterance);
        } else {
            const encodedTerm = encodeURIComponent(textToSpeak);
            const url = `https://translate.google.com/?sl=auto&text=${encodedTerm}&op=translate`;
            window.open(url, 'googleTranslate', 'width=450,height=550,top=100,left=100,scrollbars=yes');
        }
    }

    function nextQuestion() {
        isAnswering = true;
        questionCount++;
        document.getElementById('progress-display').textContent = `Q: ${questionCount}`;
        
        document.getElementById('next-btn').classList.add('hidden');
        document.getElementById('feedback-area').className = 'feedback';
        document.getElementById('feedback-area').style.display = 'none';
        document.getElementById('pronunciation-box').classList.add('hidden');
        
        currentQuestion = getRandomItem(musicTerms);
        const options = generateOptions(currentQuestion);

        const displayTerm = currentQuestion.term.charAt(0).toUpperCase() + currentQuestion.term.slice(1);
        document.getElementById('question-term').textContent = displayTerm;
        
        const ipaEl = document.getElementById('question-ipa');
        ipaEl.textContent = currentQuestion.ipa ? `[ ${currentQuestion.ipa} ]` : '';

        const optionsContainer = document.getElementById('options-container');
        optionsContainer.innerHTML = '';

        options.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            
            if (currentMode === 'zh') {
                btn.textContent = opt.def;
            } else {
                btn.textContent = opt.en;
            }

            btn.onclick = () => checkAnswer(opt, btn);
            optionsContainer.appendChild(btn);
        });
    }

    function checkAnswer(selectedOption, btnElement) {
        if (!isAnswering) return;
        isAnswering = false;

        const isCorrect = selectedOption.term === currentQuestion.term;
        const feedbackArea = document.getElementById('feedback-area');
        const feedbackTitle = document.getElementById('feedback-title');
        const feedbackContent = document.getElementById('feedback-content');

        const allBtns = document.querySelectorAll('.option-btn');
        allBtns.forEach(btn => {
            if ((currentMode === 'zh' && btn.textContent === currentQuestion.def) ||
                (currentMode === 'en' && btn.textContent === currentQuestion.en)) {
                btn.classList.add('correct');
            } else {
                btn.disabled = true;
            }
        });

        if (isCorrect) {
            score++;
            document.getElementById('score-display').textContent = `Score: ${score}`;
            btnElement.classList.add('correct');
            feedbackArea.classList.add('success');
            feedbackTitle.textContent = "Correct! Á≠îÂ∞ç‰∫ÜÔºÅ";
            feedbackTitle.style.color = "#2ECC71";
        } else {
            btnElement.classList.add('wrong');
            feedbackArea.classList.add('error');
            feedbackTitle.textContent = "Incorrect Á≠îÈåØ‰∫Ü";
            feedbackTitle.style.color = "#E74C3C";
        }

        feedbackContent.innerHTML = `
            <div style="font-size:1.1em; margin-bottom:5px;"><strong>${currentQuestion.term}</strong> (${currentQuestion.lang})</div>
            <div style="color:#555;">${currentQuestion.def}</div>
            <div style="color:#777; font-size:0.9em;">English: ${currentQuestion.en}</div>
        `;
        
        if(currentMode === 'zh') {
            const pBox = document.getElementById('pronunciation-box');
            const cText = document.getElementById('canto-text');
            const mText = document.getElementById('mando-text');
            
            if(currentQuestion.canto || currentQuestion.mando) {
                pBox.classList.remove('hidden');
                cText.textContent = currentQuestion.canto || '-';
                mText.textContent = currentQuestion.mando || '-';
            }
        }

        feedbackArea.style.display = 'block';
        document.getElementById('next-btn').classList.remove('hidden');
    }
</script>

</body>
</html>
